<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Кухня mrlOnsf</title>
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <style>
    body {font-family: 'Segoe UI', sans-serif;background:linear-gradient(135deg,#0f0f1a,#1a0b2e);color:#fff;margin:0;padding:20px;min-height:100vh;overflow-x:hidden;}
    h1 {color:#ff6b35;font-size:2.5em;text-shadow:0 0 20px #ff6b35aa;animation:glow 2s infinite alternate;}
    input {width:90%;max-width:340px;padding:16px;margin:20px 0;border-radius:16px;border:2px solid #ff6b35;background:#111;color:#fff;font-size:18px;animation:fadeIn 1s;box-shadow:0 0 15px #ff6b3533;transition:all 0.3s;}
    input:focus {outline:none;border-color:#ff9500;box-shadow:0 0 25px #ff9500aa;}
    button {background:linear-gradient(45deg,#ff6b35,#ff9500);color:#fff;border:none;padding:16px 28px;margin:8px;border-radius:16px;font-size:18px;cursor:pointer;min-width:160px;box-shadow:0 5px 20px #ff6b3588;transition:all 0.4s;animation:pulseBtn 2s infinite;}
    button:hover {transform:translateY(-5px) scale(1.05);box-shadow:0 10px 30px #ff6b35aa;}
    button:active {transform:scale(0.95);}
    #result {margin-top:30px;padding:25px;background:rgba(20,20,40,0.8);border-radius:20px;display:none;backdrop-filter:blur(10px);border:1px solid #ff6b3566;animation:slideUp 0.8s ease-out;}
    #generatedImage {max-width:100%;border-radius:16px;margin-top:15px;box-shadow:0 10px 40px rgba(255,107,53,0.6);animation:popIn 0.8s ease-out;}
    .loading {animation:pulse 1.5s infinite;color:#ff6b35;font-size:20px;text-shadow:0 0 10px #ff6b35;}
    
    @keyframes glow {from{text-shadow:0 0 10px #ff6b35;}to{text-shadow:0 0 30px #ff6b35,0 0 40px #ff9500;}}
    @keyframes pulseBtn {0%,100%{transform:scale(1);}50%{transform:scale(1.08);}}
    @keyframes fadeIn {from{opacity:0;transform:translateY(20px);}to{opacity:1;transform:none;}}
    @keyframes slideUp {from{opacity:0;transform:translateY(50px);}to{opacity:1;transform:none;}}
    @keyframes popIn {from{opacity:0;transform:scale(0.8);}to{opacity:1;transform:scale(1);}}
    @keyframes spin {from{transform:rotate(0deg);}to{transform:rotate(360deg);}}
    .spinner {display:inline-block;width:30px;height:30px;border:4px solid #ff6b35;border-top:4px solid #fff;border-radius:50%;animation:spin 1s linear infinite;margin-right:10px;}
  </style>
</head>
<body>
  <h1>Кухня mrlOnsf</h1>
  <p style="animation:fadeIn 1.5s;font-size:18px;">Всё с анимациями — просто огонь!</p>

  <input type="text" id="query" placeholder="кот в космосе / рецепт пасты / 2+2*5" autofocus>

  <div style="margin:20px 0;">
    <button onclick="generateImage()">Картинка</button>
    <button onclick="generateRecipe()">Рецепт + ккал</button>
    <button onclick="googleSearch()">Поиск Google</button>
    <button onclick="solveMath()">Математика</button>
    <button onclick="makePresentation()">Презентация</button>
  </div>

  <div id="result">
    <p class="loading"><span class="spinner"></span>Генерируем магию...</p>
    <img id="generatedImage" src="" style="display:none;">
  </div>

  <script>
    Telegram.WebApp.ready();
    Telegram.WebApp.expand();

    const TAVILY_KEY = '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';
    const HF_TOKEN = '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';

    function show(html = '') {
      const result = document.getElementById('result');
      result.innerHTML = '<p class="loading"><span class="spinner"></span>Генерируем магию...</p>' + html;
      result.style.display = 'block';
    }

    async function generateImage() {
      const prompt = document.getElementById('query').value || 'кот в космосе';
      show();
      try {
        const r = await fetch('https://api-inference.huggingface.co/models/black-forest-labs/FLUX.1-schnell', {
          method:'POST', headers:{'Authorization':`Bearer ${HF_TOKEN}`},
          body:JSON.stringify({inputs:prompt})
        });
        const blob = await r.blob();
        const url = URL.createObjectURL(blob);
        document.getElementById('generatedImage').src = url;
        document.getElementById('generatedImage').style.display = 'block';
        document.getElementById('result').innerHTML = `<h3 style="animation:fadeIn 1s;">Готово: ${prompt}</h3>`;
      } catch { show('<p style="color:#ff4444;">Ошибка генерации</p>'); }
    }

    async function generateRecipe() {
      const q = document.getElementById('query').value || 'ужин';
      show();
      const r = await fetch('https://api-inference.huggingface.co/models/Qwen/Qwen2.5-32B-Instruct', {
        method:'POST', headers:{'Authorization':`Bearer ${HF_TOKEN}`,'Content-Type':'application/json'},
        body:JSON.stringify({inputs:`Простой рецепт: ${q}. Ингредиенты, шаги, калории. Живой язык.`})
      });
      const d = await r.json();
      show(`<pre style="text-align:left;animation:fadeIn 1s;">${d[0]?.generated_text || 'Готово!'}</pre>`);
    }

    async function googleSearch() {
      const q = document.getElementById('query').value || 'что-то';
      show();
      const r = await fetch('https://api.tavily.com/search', {
        method:'POST', headers:{'Content-Type':'application/json'},
        body:JSON.stringify({api_key:TAVILY_KEY, query:q, include_answer:true, max_results:3})
      });
      const d = await r.json();
      const txt = d.answer || d.results.map(x=>`<p style="animation:fadeIn 1s;"><b>${x.title}</b><br>${x.content}<br><a href="${x.url}" style="color:#ff6b35;">Источник</a></p>`).join('');
      show(txt || 'Ничего не нашёл');
    }

    async function solveMath() {
      const q = document.getElementById('query').value || '2+2';
      show();
      const script = document.createElement('script');
      script.src = 'https://cdnjs.cloudflare.com/ajax/libs/mathjs/12.4.1/math.min.js';
      script.onload = () => {
        try { show(`<h3 style="animation:fadeIn 1s;">Ответ:</h3><p style="font-size:28px;animation:popIn 1s;">${math.evaluate(q)}</p>`); }
        catch { show('<p style="color:#ff4444;">Не решил</p>'); }
      };
      document.head.appendChild(script);
    }

    async function makePresentation() {
      show('<p style="animation:fadeIn 1s;">Генерирую презентацию... (5 сек)</p>');
      setTimeout(() => {
        show(`<h3 style="animation:fadeIn 1s;">Презентация готова!</h3><p style="animation:fadeIn 1.5s;"><button onclick="alert('Скачиваю...')">Скачать PPTX</button></p>`);
      }, 3000);
    }
  </script>
</body>
</html>
